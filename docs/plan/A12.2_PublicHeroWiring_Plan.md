# A12.2 — Public Hero Wiring Plan

**Created:** 2025-12-18  
**Status:** Documented / Code-reviewed wiring  
**Scope:** Documentation only (no code changes in this phase)

---

## Overview

This document provides a concrete, minimal, work-safe plan for wiring the public Zivan homepage Hero to Supabase `hero_sections` table.

**Key Finding:** Code review indicates that wiring already exists. This document confirms the current state and documents deferred fields.

---

## A) Inventory

### Public Hero Component

| Item | Location |
|------|----------|
| **Hero Component** | `apps/public/src/components/Hero/index.jsx` |
| **Home Page** | `apps/public/src/components/Pages/Home.jsx` |
| **Data Hook** | `apps/public/src/hooks/useContent.js` → `useHeroSections()` |

### Hero Component Props (from code review)

```jsx
// apps/public/src/components/Hero/index.jsx
const Hero = ({ title, subtitle, videoSrc, bgUrl }) => { ... }
```

| Prop | Type | Description |
|------|------|-------------|
| `title` | Array | Array of strings for rotating text animation |
| `subtitle` | String | Static subtitle text |
| `videoSrc` | String | YouTube/video URL for VideoModal |
| `bgUrl` | String | Background image URL |

### CSS Classes Lock (Zivan 1:1)

The following markup MUST remain unchanged:

- `cs_hero cs_style_1` — main section classes
- `cs_hero_title` — heading classes
- `TextTransition` — rotating text animation component
- `VideoModal` — video modal integration
- All spacing, typography, and layout classes

**⚠️ DO NOT CHANGE** any CSS classes, DOM structure, or styling in `Hero/index.jsx`.

---

## B) Data Mapping

### Currently Mapped Fields (code-reviewed)

| DB Field (`hero_sections`) | Hero Prop | Transform | Fallback |
|----------------------------|-----------|-----------|----------|
| `heading` | `title` | Wrap in array: `[heading]` | 4-phrase rotating array (hardcoded) |
| `subheading` | `subtitle` | Direct pass | Static tagline (hardcoded) |
| `background_video_url` | `videoSrc` | Direct pass | YouTube URL (hardcoded) |
| `background_image_url` | `bgUrl` | Direct pass | Local image path (hardcoded) |

### Transform Logic (from Home.jsx code review)

```javascript
// apps/public/src/components/Pages/Home.jsx
const transformHeroData = (heroData) => {
  if (!heroData || heroData.length === 0) {
    return fallbackHeroData; // Uses hardcoded fallback
  }
  const hero = heroData[0]; // First active hero
  return {
    title: [hero.heading], // Wrap in array for TextTransition
    subtitle: hero.subheading,
    videoSrc: hero.background_video_url,
    bgUrl: hero.background_image_url,
  };
};
```

### Unmapped Fields (DEFERRED)

The following fields exist in `hero_sections` but are **NOT mapped** because mapping them would require UI changes, which violates Zivan 1:1 lock:

| DB Field | Reason NOT Mapped | Resolution |
|----------|-------------------|------------|
| `cta_text` | Hero component has no CTA button | DEFERRED — would require adding DOM element |
| `cta_link` | Hero component has no CTA button | DEFERRED — would require adding DOM element |
| `overlay_opacity` | No CSS variable or inline style for overlay | DEFERRED — would require markup changes |
| `text_alignment` | Hero uses fixed center alignment | DEFERRED — would require class logic changes |
| `sort_order` | Used for ordering multiple heroes (currently takes first) | N/A — query behavior |
| `is_active` | Used in query filter | N/A — query behavior |

**Decision:** These fields remain in the database and Admin CRUD but are not rendered on the public site until Zivan 1:1 lock is lifted.

---

## C) Fetch & Runtime Behavior

### Current Query (from useContent.js code review)

```javascript
// apps/public/src/hooks/useContent.js
export const useHeroSections = () => {
  return useQuery({
    queryKey: ['heroSections'],
    queryFn: async () => {
      const { data, error } = await supabase
        .from('hero_sections')
        .select('*')
        .eq('is_active', true)
        .order('sort_order', { ascending: true });
      if (error) throw error;
      return data;
    },
  });
};
```

### Loading Behavior

- **No skeleton/loading UI** — the Hero uses fallback data until query completes
- **Seamless transition** — if data arrives, it replaces fallback without layout shift
- **Fallback-first** — user always sees content immediately (hardcoded fallback or CMS data)

### Error Behavior

- **Silent fallback** — if query fails, fallback data is used
- **Console logging** — React Query logs errors to console
- **No user-facing error state** — Hero always displays content

---

## D) "Do Not Change" UI Constraints

### Zivan 1:1 Lock

| Constraint | Applies To |
|------------|------------|
| ❌ No new DOM elements | Cannot add CTA button |
| ❌ No class changes | Cannot modify `cs_hero`, `cs_hero_title`, etc. |
| ❌ No layout changes | Cannot change spacing, alignment, structure |
| ❌ No new animations | `TextTransition` is the only animation |
| ❌ No style changes | Cannot add inline styles or CSS variables |

### Darkone 1:1 Lock

| Constraint | Applies To |
|------------|------------|
| ❌ No Admin UI refactors | Hero CRUD (A12.1) is complete and unchanged |
| ❌ No new shared components | Follow existing patterns |

---

## E) Verification Checklist (for future reference)

If implementation work is ever done on this wiring, the following must be verified:

| # | Check | Notes |
|---|-------|-------|
| 1 | Build passes (`apps/public`) | `cd apps/public && bun run build` |
| 2 | Homepage hero looks identical to Zivan reference | Pixel parity |
| 3 | When active hero exists in DB, content displays | Query returns data |
| 4 | When no active hero exists, fallback displays | Hardcoded fallback |
| 5 | No console errors | Clean console |
| 6 | No layout shift during data load | Fallback → CMS seamless |

---

## F) Status Declaration

| Item | Status |
|------|--------|
| **Code-reviewed wiring exists** | ✅ Yes (Home.jsx → useHeroSections → hero_sections) |
| **Runtime verified** | ⚠️ NOT verified in this phase (requires login + data) |
| **Mapped fields** | 4 of 8 (`heading`, `subheading`, `background_video_url`, `background_image_url`) |
| **Unmapped fields** | 4 of 8 (`cta_text`, `cta_link`, `overlay_opacity`, `text_alignment`) — DEFERRED |
| **Code changes needed** | NONE (wiring already exists) |
| **Phase A12.2 outcome** | Documentation only — confirms existing wiring |

---

## G) Next Steps (Future Phases — NOT in A12.2)

The following are **explicitly out of scope** for A12.2:

1. **A12.3 — Site Settings Expansion:** Expose additional `site_settings` fields in Admin
2. **CTA Wiring:** If Zivan 1:1 lock is lifted, add CTA button to Hero and map `cta_text`/`cta_link`
3. **Runtime Verification:** Login to public app with seeded `hero_sections` data to verify wiring
4. **Media Library:** Implement centralized media management (placeholder exists)

**Await Further Instructions** before proceeding with any of the above.
